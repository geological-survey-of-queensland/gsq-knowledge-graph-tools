# Excel to LPG Graph Converter

## Overview

This repository contains a Python script excel_to_lpg.py that automates the conversion of graph data stored in a structured Excel template to a JSON file representing a Labelled Property Graph (LPG). Graph nodes and edges are described in separate Excel sheets which are then processed and validated to create a coherent JSON graph structure.

## Python Script (excel_to_lpg.py)

### Description

The script excel_to_lpg.py reads graph data from the lpg_template.xlsx Excel file, validates the integrity of nodes and edges, and generates a JSON file lpg_graph.json representing the graph. The script assigns UUIDs to edges missing an ID and ensures all edges refer to existing nodes.

### Usage

To run the script, ensure that Python 3 and the pandas library are installed on your system. Execute the script in the terminal using the python command followed by the script name.

### Functions

- validate_nodes(nodes, edges): Checks if all source and target nodes listed in the edges tab exist in the nodes tab and raises a ValueError if any are missing.
- Data extraction is handled by reading the nodes and edges sheets from the Excel file.
- UUID assignment for edges without an ID.
- Conversion of DataFrame rows to JSON format, with additional handling for node and edge properties.
- Combining nodes and edges JSON objects into a single graph and writing it to an output JSON file.

## Excel Template (lpg_template.xlsx)

### Description

The lpg_template.xlsx Excel file is the source for graph data that includes two sheets:

- nodes: Lists individual nodes with their respective properties.
- edges: Lists relationships between nodes along with edge properties.

### Structure

- nodes: Must contain columns named node, label, and any number of additional property columns.
- edges: Must contain columns named edge, source, label, target, and any number of additional property columns. The edge column may be left blank to be automatically filled with a UUID.

### Guidelines

Ensure that the Excel template follows the correct format for nodes and edges. Each row represents a separate entity (node or edge), and custom properties can be added as new columns. The script assumes that the column headers for properties do not contain the specific string 'add properties -->'.

### Demo

An example xlsx file (demo/lpg_template.xlsx) is provided to assist with using the template and test out the converter. This file is also compatible with 2D_lpg_viewer.html tool at the top of the lpg directory of this repo.  

## Output JSON (lpg_graph.json)

### Description

After successful execution of the script, the lpg_graph.json file contains the JSON representation of the graph.

### Structure

The JSON file consists of two top-level keys:

- nodes: An array of node objects, each with an id, label, and a properties object.
- edges: An array of edge objects, each with an id, source, label, target, and a properties object.

### Format

The JSON file is structured with a human-readable indent of 2 spaces. Each node and edge has a unique identifier, where edges without an initial identifier are assigned a UUID. The properties of nodes and edges in the JSON output are filtered to exclude null values and columns not pertaining to properties.

### Sample JSON Node

{
  "id": "node_id",
  "label": "NodeLabel",
  "properties": {
    "propertyKey": "propertyValue",
    "Additional properties"
  }
}

### Sample JSON Edge

{
  "id": "edge_id",
  "source": "source_node_id",
  "label": "EdgeLabel",
  "target": "target_node_id",
  "properties": {
    "propertyKey": "propertyValue",
    "Additional properties"
  }
}

For the full JSON structure, refer to the lpg_graph.json file generated by the Python script.

### Demo

An example graph output JSON is also provided (demo/lpg_graph.json), you can view the JSON in a text editor or open it in the 2D_lpg_viewer.html tool at the top of the lpg directory of this repo. 